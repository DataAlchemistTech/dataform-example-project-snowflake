config {
  type: "table",
  tags: ["reporting"]
}

select
  orders.order_date as date,
  customers.country_group as country_group,
  count(orders.order_key) as order_count,
  sum(orders.total_price) as total_price,
  sum(line_items) as line_items
from
  ${ref("order_stats")} orders
  left join ${ref("customer_stats")} customers
    on orders.customer_key = customers.customer_key
group by
  1,2